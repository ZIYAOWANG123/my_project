---
title: "My map"
author: "ZIYAO WANG (Billy)"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: true
      number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, warning = F)
Sys.setlocale("LC_ALL","English")
```

```{r load-lib, message=FALSE}
library(tidyverse)
library(sf)
library(leaflet)
```

# 2022 Election data (House of representatives - Two party preferred by division)

## VIC Maps

```{r vic-map}
vic_elect_map <- read_sf(here::here("data/vic-july-2021-esri/E_VIC21_region.shp")) %>% 
  select(-c(Total_Popu, Australian)) %>% 
  mutate(centroid = st_centroid(geometry))

vic_elect_data <- read.csv(here::here("data/2022Election_HouseTppByDivision.csv")) %>% 
  filter(StateAb == "VIC")

map_data <- left_join(vic_elect_data,vic_elect_map,
                      by = c("DivisionNm" = "Elect_div"))

ggplot(map_data, aes(fill =  PartyAb))+
  geom_sf(aes(geometry = geometry))+
  guides(fill = guide_legend("Party"))+
  theme_void() + 
  theme(legend.position="bottom")

ggplot(map_data) + 
  geom_sf(aes(geometry = geometry)) + 
  geom_sf(aes(geometry = centroid, color = PartyAb)) +
  guides(color = guide_legend("Party"))+
  theme_void() + 
  theme(legend.position="bottom")

```

### Interaction Maps - VIC Election

```{r vic-leaflet}

```



## National Maps

```{r au-map}
sf_use_s2(T)
aec_map <- read_sf(here::here("data/Cwlth_electoral_boundaries_ESRI/2021_ELB_region.shp")) %>% 
  select(-c(Total_Popu, Australian)) %>% 
  st_make_valid(geometry) %>% 
  mutate(centroid = st_centroid(geometry))

aec_data <- read.csv(here::here("data/2022Election_HouseTppByDivision.csv"))

aec_mapdata <- left_join(aec_data,aec_map,
                      by = c("DivisionNm" = "Elect_div"))

ggplot(aec_mapdata, aes(fill =  PartyAb))+
  geom_sf(aes(geometry = geometry))+
  guides(fill = guide_legend("Party"))+
  theme_void() + 
  theme(legend.position="bottom")

ggplot(aec_mapdata) + 
  geom_sf(aes(geometry = geometry)) + 
  geom_sf(aes(geometry = centroid, color = PartyAb)) +
  guides(color = guide_legend("Party"))+
  theme_void() + 
  theme(legend.position="bottom")
```

### Interaction Maps - Australian Election

```{r au-leaflet}

```




